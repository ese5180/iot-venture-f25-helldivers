########################
# General
########################
CONFIG_LOG=y
CONFIG_LOG_BUFFER_SIZE=2048
CONFIG_HW_ID_LIBRARY=y
CONFIG_ASSERT=y
CONFIG_JSON_LIBRARY=y
CONFIG_REBOOT=y

CONFIG_STDOUT_CONSOLE=y
CONFIG_UART_INTERRUPT_DRIVEN=y
CONFIG_PICOLIBC_IO_FLOAT=y
CONFIG_LOG_MODE_IMMEDIATE=y
# 日志总开关等级：0=NONE, 1=ERR, 2=WRN, 3=INF, 4=DBG
CONFIG_LOG_DEFAULT_LEVEL=3

########################
# GNSS / nRF Cloud (可选，用于 A-GNSS)
########################
# 如果后面不打算用 nRF Cloud A-GNSS，也可以把这一行改成 n
CONFIG_NRF_CLOUD=y

#CONFIG_GNSS_SAMPLE_ASSISTANCE_NRF_CLOUD=n

# Request eDRX from the network
CONFIG_LTE_LC_EDRX_MODULE=n
CONFIG_LTE_EDRX_REQ=n

# PSM requested periodic TAU 8 hours
CONFIG_LTE_LC_PSM_MODULE=n
#CONFIG_LTE_PSM_REQ_RPTAU="00101000"
# PSM requested active time 6 seconds
#CONFIG_LTE_PSM_REQ_RAT="00000011"

# AT Host library - 用于 AT 命令调试，咱们先关掉
CONFIG_AT_HOST_LIBRARY=n

########################
# Heap and stacks
########################
CONFIG_HEAP_MEM_POOL_SIZE=16384
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_AT_MONITOR_HEAP_SIZE=1024
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096

########################
# Network
########################
CONFIG_NETWORKING=y
CONFIG_NET_NATIVE=y
CONFIG_NET_IPV4=y
CONFIG_NET_CONNECTION_MANAGER=y

# 不启用 Zephyr 自己的软件 TLS（我们用的是 modem offload）
# 所以这里不要 CONFIG_NET_SOCKETS_SOCKOPT_TLS

########################
# AWS IoT / MQTT
########################
CONFIG_AWS_IOT=y

# 固定 client ID（也可以改用 hw_id，这里只是兜底）
CONFIG_AWS_IOT_CLIENT_ID_STATIC="device_horse"

# 你的 AWS IoT endpoint（注意和 AWS 控制台一致）
CONFIG_AWS_IOT_BROKER_HOST_NAME="aee37ebj3uql3-ats.iot.us-east-1.amazonaws.com"

# Shadow 相关 topic 订阅
CONFIG_AWS_IOT_TOPIC_UPDATE_DELTA_SUBSCRIBE=y
CONFIG_AWS_IOT_TOPIC_GET_ACCEPTED_SUBSCRIBE=y
CONFIG_AWS_IOT_TOPIC_GET_REJECTED_SUBSCRIBE=y

# sample 里用到的一些 Kconfig（避免 undefined）
CONFIG_AWS_IOT_SAMPLE_APP_VERSION="v1.0.0"
CONFIG_AWS_IOT_SAMPLE_JSON_MESSAGE_SIZE_MAX=2048
CONFIG_AWS_IOT_SAMPLE_PUBLICATION_INTERVAL_SECONDS=60
CONFIG_AWS_IOT_SAMPLE_CONNECTION_RETRY_TIMEOUT_SECONDS=10

# 使用硬件 ID 作为 device_id（配合 main.c 里的 hw_id_get）
CONFIG_AWS_IOT_SAMPLE_DEVICE_ID_USE_HW_ID=y

########################
# MQTT helper library
########################
CONFIG_MQTT_HELPER=y
CONFIG_MQTT_HELPER_SEC_TAG=201
CONFIG_MQTT_HELPER_LAST_WILL=y
CONFIG_MQTT_HELPER_STACK_SIZE=4096
CONFIG_MQTT_HELPER_PORT=8883

# Maximum MQTT keepalive timeout specified by AWS IoT Core
CONFIG_MQTT_KEEPALIVE=1200
CONFIG_MQTT_CLEAN_SESSION=y

########################
# Modem / LTE
########################

# 让 socket 走 nRF91 调制解调器（包含 TLS offload）
CONFIG_NET_SOCKETS_OFFLOAD=y

# 一些库（比如 GNSS sample）会用到 POSIX API
CONFIG_POSIX_API=y

# LTE 链路控制
CONFIG_LTE_LINK_CONTROL=y

# ⭐ 最关键：让 modem 处于 LTE-M + GNSS 模式
CONFIG_LTE_NETWORK_MODE_LTE_M_GPS=y

# 旧版本里有 CONFIG_LTE_AUTO_INIT_AND_CONNECT，现在已经被移除
# 所以这里千万不要再写 CONFIG_LTE_AUTO_INIT_AND_CONNECT=...
# 由应用代码自己调用 lte_lc_init_and_connect()

# GNSS API 在当前 SDK 里不需要单独的 CONFIG_NRF_MODEM_GNSS 选项，
# 只要上面这个 LTE_M_GPS 打开即可。
# 以前我们写过：
# CONFIG_NRF_MODEM_GNSS=y
# 但这个符号在 NCS 3.0.2 里已经不存在，会导致 Kconfig 报 undefined symbol。
# 所以这里不要再加这行！

# 关闭 modem trace，省功耗
CONFIG_NRF_MODEM_LIB_TRACE=n

########################
# PDN / APN 配置
########################
CONFIG_PDN=y
CONFIG_PDN_DEFAULTS_OVERRIDE=y
# ✅ 按你要求保留这个“错误”的拼写
CONFIG_PDN_DEFAULT_APN="onomodo"

########################
# Modem key management (证书)
########################
CONFIG_MODEM_KEY_MGMT=y

########################
# Modem info（给 shadow 里面的 modem_version 用）
########################
CONFIG_MODEM_INFO=y

########################
# Modem library 基本设置
########################
CONFIG_NRF_MODEM_LIB=y
CONFIG_AT_CMD_CUSTOM=y

# Align the max FD entry to NRF_MODEM_MAX_SOCKET_COUNT(8)
CONFIG_ZVFS_OPEN_MAX=8

# Handle modem fault
CONFIG_NRF_MODEM_LIB_ON_FAULT_APPLICATION_SPECIFIC=y

########################
# ==== OTA (MCUboot + 下载客户端) ====
########################
CONFIG_AWS_FOTA=y
CONFIG_FOTA_DOWNLOAD=y
CONFIG_DFU_TARGET=y
CONFIG_IMG_MANAGER=y
CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_AWS_FOTA_DOWNLOAD_SECURITY_TAG=201

########################
# Memfault OTA (NCS 3.0.2 Compatible) — 先全部关掉
########################

# CONFIG_MEMFAULT=y
# CONFIG_MEMFAULT_SDK=y
# CONFIG_MEMFAULT_NCS_USE_DEFAULTS=y
# CONFIG_MEMFAULT_HTTP=y
# CONFIG_MEMFAULT_HTTP_UPLOAD=y
# CONFIG_MEMFAULT_FOTA=y
# CONFIG_IMG_ERASE_PROGRESSIVELY=y
# CONFIG_DOWNLOAD_CLIENT=y

# 允许较大的 SSL message（Memfault 或 AWS 大 payload 时有用）
CONFIG_MBEDTLS_SSL_MAX_CONTENT_LEN=4096


#i2c
CONFIG_I2C=y
CONFIG_I2C_NRFX=y
CONFIG_SENSOR=y
CONFIG_BME280=y
CONFIG_LOG=y
CONFIG_CBPRINTF_FP_SUPPORT=y

# CONFIG_SHELL=y
# CONFIG_I2C_SHELL=y



